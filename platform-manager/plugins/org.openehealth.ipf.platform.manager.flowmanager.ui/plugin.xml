<?xml version="1.0" encoding="UTF-8"?>
<!--
    Copyright 2008 the original author or authors.

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

        http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
	limitations under the License. -->
<?eclipse version="3.2"?>
<plugin>

   <extension
         point="org.eclipse.ui.commands">
      <category
            name="Flow Manager Category"
            id="org.openehealth.ipf.platform.manager.flowmanager.ui.commands.category">
      </category>
      <command
            name="%openflowmanager"
            categoryId="org.openehealth.ipf.platform.manager.flowmanager.ui.commands.category"
            id="org.openehealth.ipf.platform.manager.flowmanager.ui.commands.openflowmanager">
      </command>
      <command
            categoryId="org.openehealth.ipf.platform.manager.flowmanager.ui.commands.category"
            id="org.openehealth.ipf.platform.manager.flowmanager.ui.setEnableFiltering"
            name="%setenablefiltering">
      </command>
      <command
            categoryId="org.openehealth.ipf.platform.manager.flowmanager.ui.commands.category"
            id="org.openehealth.ipf.platform.manager.flowmanager.ui.setApplication"
            name="%setapplication">
      </command>
      <command
            categoryId="org.openehealth.ipf.platform.manager.flowmanager.ui.commands.category"
            id="org.openehealth.ipf.platform.manager.flowmanager.ui.setupperTimeLimit"
            name="%setuppertimelimit">
      </command>
      <command
            categoryId="org.openehealth.ipf.platform.manager.flowmanager.ui.commands.category"
            id="org.openehealth.ipf.platform.manager.flowmanager.ui.setMaxFlows"
            name="%setmaxflows">
      </command>
      <command
            categoryId="org.openehealth.ipf.platform.manager.flowmanager.ui.commands.category"
            id="org.openehealth.ipf.platform.manager.flowmanager.ui.setEnableFiltering"
            name="%setenablefiltering">
      </command>
      <command
            categoryId="org.openehealth.ipf.platform.manager.flowmanager.ui.commands.category"
            id="org.openehealth.ipf.platform.manager.flowmanager.ui.setEnableCleanup"
            name="%setenablecleanup">
      </command>
      <command
            categoryId="org.openehealth.ipf.platform.manager.flowmanager.ui.commands.category"
            id="org.openehealth.ipf.platform.manager.flowmanager.ui.search"
            name="%searchflows">
      </command>
      <command
            categoryId="org.openehealth.ipf.platform.manager.flowmanager.ui.commands.category"
            id="org.openehealth.ipf.platform.manager.flowmanager.ui.replayFlows"
            name="%replayflows">
      </command>
      <command
            categoryId="org.openehealth.ipf.platform.manager.flowmanager.ui.commands.category"
            id="org.openehealth.ipf.platform.manager.flowmanager.ui.show.flow.message"
            name="%flow">
      </command>
      <command
            categoryId="org.openehealth.ipf.platform.manager.flowmanager.ui.commands.category"
            id="org.openehealth.ipf.platform.manager.flowmanager.ui.show.all.content"
            name="%show_all_content">
      </command>
   </extension>
   <extension
         point="org.eclipse.ui.handlers">
      <handler
            commandId="org.openehealth.ipf.platform.manager.flowmanager.ui.commands.openflowmanager"
            class="org.openehealth.ipf.platform.manager.flowmanager.ui.handlers.OpenFlowManagerHandler">
         <enabledWhen>
            <reference
                  definitionId="org.openehealth.ipf.platform.manager.flowmanager.ui.connection.ui.single.selection">
            </reference>
         </enabledWhen>
      </handler>
      <handler
            class="org.openehealth.ipf.platform.manager.flowmanager.ui.handlers.ChangeFlowManagerFlowFilteringHandler"
            commandId="org.openehealth.ipf.platform.manager.flowmanager.ui.setEnableFiltering">
      </handler>
      <handler
            class="org.openehealth.ipf.platform.manager.flowmanager.ui.handlers.ChangeFlowManagerEnableCleanupHandler"
            commandId="org.openehealth.ipf.platform.manager.flowmanager.ui.setEnableCleanup">
      </handler>
       <handler
            commandId="org.openehealth.ipf.platform.manager.flowmanager.ui.setApplication"
            class="org.openehealth.ipf.platform.manager.flowmanager.ui.handlers.SetFlowManagerApplicationHandler">
      </handler>
      <handler
            class="org.openehealth.ipf.platform.manager.flowmanager.ui.handlers.SetFlowManagerMaxFlowsHandler"
            commandId="org.openehealth.ipf.platform.manager.flowmanager.ui.setMaxFlows">
      </handler>
      <handler
            class="org.openehealth.ipf.platform.manager.flowmanager.ui.handlers.SearchFlowsHandler"
            commandId="org.openehealth.ipf.platform.manager.flowmanager.ui.search">
         <enabledWhen>
            <reference
                  definitionId="org.openehealth.ipf.platform.manager.flowmanager.ui.active.editor.is.flowmanager.editor">
            </reference></enabledWhen>
      </handler>
      <handler
            class="org.openehealth.ipf.platform.manager.flowmanager.ui.handlers.ReplayFlowHandler"
            commandId="org.openehealth.ipf.platform.manager.flowmanager.ui.replayFlows">
         <enabledWhen>
            <reference
                  definitionId="org.openehealth.ipf.platform.manager.ui.flows.nonempty.selection">
            </reference>
         </enabledWhen>
      </handler>
      <handler
            class="org.openehealth.ipf.platform.manager.flowmanager.ui.handlers.ShowIncomingContentHandler"
            commandId="org.openehealth.ipf.platform.manager.flowmanager.ui.show.flow.message">
         <enabledWhen>
            <reference
                  definitionId="org.openehealth.ipf.platform.manager.ui.flows.nonempty.selection">
            </reference>
         </enabledWhen>
      </handler>
    <handler
            class="org.openehealth.ipf.platform.manager.flowmanager.ui.handlers.ShowAllContentHandler"
            commandId="org.openehealth.ipf.platform.manager.flowmanager.ui.show.all.content">
      </handler>
   </extension>
   <extension
         point="org.eclipse.ui.bindings">
      <key
            commandId="org.openehealth.ipf.platform.manager.flowmanager.ui.commands.openflowmanager"
            contextId="org.eclipse.ui.contexts.window"
            sequence="F3"
            schemeId="org.eclipse.ui.defaultAcceleratorConfiguration">
      </key>
   </extension>
   <extension
         point="org.eclipse.ui.menus">
      <menuContribution
            locationURI="menu:org.eclipse.ui.main.menu?after=org.openehealth.ipf.platform.manager.connection.ui.main.menu">
         <menu
               label="%flowmanager_menu_name"
               id="org.openehealth.ipf.platform.manager.flowmanager.ui.menu.flowmanager">
            <command
                  commandId="org.openehealth.ipf.platform.manager.flowmanager.ui.commands.openflowmanager"
                  id="org.openehealth.ipf.platform.manager.flowmanager.ui.menuitem.openflowmanager">
            </command>
            <command
                  commandId="org.openehealth.ipf.platform.manager.flowmanager.ui.replayFlows"
                  icon="icons/control_play_blue.png">
            </command>
            <separator
                  name="org.openehealth.ipf.platform.manager.flowmanager.ui.separator2">
            </separator>
            <command
                  commandId="org.openehealth.ipf.platform.manager.flowmanager.ui.search"
                  icon="icons/find.png">
            </command>
            <separator
                  name="org.openehealth.ipf.platform.manager.flowmanager.ui.separator1"
                  visible="true">
            </separator>
            <menu
                  icon="icons/email.png"
                  label="%show_message">
               <command
                     commandId="org.openehealth.ipf.platform.manager.flowmanager.ui.show.flow.message"
                     style="push"
                     tooltip="%show_flow_message_tooltip">
               </command>
               <dynamic
                     class="org.openehealth.ipf.platform.manager.flowmanager.ui.menu.ShowOutgoingContentDynamicMenu"
                     id="org.openehealth.ipf.platform.manager.flowmanager.ui.flowmessage.dynamic">
               </dynamic>
            </menu>
         </menu>
      </menuContribution>
      <menuContribution
            locationURI="popup:org.openehealth.ipf.platform.manager.connection.ui.view.ConnectionView?after=org.openehealth.ipf.platform.manager.connection.ui.separator1">
         <command
               commandId="org.openehealth.ipf.platform.manager.flowmanager.ui.commands.openflowmanager"
               id="org.openehealth.ipf.platform.manager.flowmanager.ui.popup.menu.openflowmanager">
         </command>
      </menuContribution>
      <menuContribution
            locationURI="popup:org.openehealth.ipf.platform.manager.flowmanager.ui.view.SearchView?after=additions">
         <command
               commandId="org.openehealth.ipf.platform.manager.flowmanager.ui.replayFlows"
               icon="icons/control_play_blue.png"
               id="org.openehealth.ipf.platform.manager.flowmanager.ui.popup.menu.flows">
         </command>
         <separator
               name="org.openehealth.ipf.platform.manager.flowmanager.ui.separator2"
               visible="true">
         </separator>
         <menu
               icon="icons/email.png"
               label="%show_message">
            <command
                  commandId="org.openehealth.ipf.platform.manager.flowmanager.ui.show.flow.message"
                  style="push"
                  tooltip="%show_flow_message_tooltip">
            </command>
            <dynamic
                  class="org.openehealth.ipf.platform.manager.flowmanager.ui.menu.ShowOutgoingContentDynamicMenu"
                  id="org.openehealth.ipf.platform.manager.flowmanager.ui.flowmessage.dynamic">
            </dynamic>
         </menu>
      </menuContribution>
      <menuContribution
            locationURI="toolbar:main?after=org.openehealth.ipf.platform.manager.connection.ui.new.id">
         <command
               commandId="org.openehealth.ipf.platform.manager.flowmanager.ui.replayFlows"
               icon="icons/control_play_blue.png">
         </command>
      </menuContribution>
   </extension>
   <extension
         id="editorID"
         point="org.eclipse.ui.editors">
      <editor
            class="org.openehealth.ipf.platform.manager.flowmanager.ui.editor.FlowManagerEditor"
            default="true"
            extensions="connection"
            icon="icons/computer.png"
            id="org.openehealth.ipf.platform.manager.flowmanager.ui.editor.FlowManagerEditor"
            name="%Flow_manager_editor_name">
         <contentTypeBinding
               contentTypeId="org.openehealth.ipf.platform.manager.flowmanager.ui.contentTypeBinding2">
         </contentTypeBinding>
       </editor>
   </extension>
   <!--extension
         point="org.eclipse.core.runtime.adapters">
      <factory
            adaptableType="org.openehealth.ipf.platform.manager.flow.transfer.FlowInfo"
            class="org.openehealth.ipf.platform.manager.flowmanager.ui.adapter.FlowManagerAdapterFactory">
         <adapter
               type="org.openehealth.ipf.platform.manager.flowmanager.ui.adapter.FlowInfoAdapter">
         </adapter>
      </factory>
   </extension-->
   <extension
         point="org.eclipse.core.expressions.definitions">
      <definition
            id="org.openehealth.ipf.platform.manager.ui.flows.nonempty.selection">
             <and>
            <with
                  variable="selection">
               <count
                     value="+">
               </count>
             </with>
             <with
                  variable="activePartId">
               <equals
                     value="org.openehealth.ipf.platform.manager.flowmanager.ui.view.SearchView">
               </equals>
            </with>
             </and>
      </definition>
       <definition
            id="org.openehealth.ipf.platform.manager.flowmanager.ui.connection.ui.single.selection">
         <and>
             <with variable="selection">
  				<count value="+"/>
  				<iterate operator="and">
	     			<adapt 	type="org.openehealth.ipf.platform.manager.connection.IConnectionConfiguration">
     				</adapt>
     			</iterate>
  			</with>
         </and>
     </definition>
      <definition
            id="org.openehealth.ipf.platform.manager.flowmanager.ui.active.editor.is.flowmanager.editor">
         <with
               variable="activeEditorId">
            <equals
                  value="org.openehealth.ipf.platform.manager.flowmanager.ui.editor.FlowManagerEditor">
            </equals>
         </with>

      </definition>
      <definition
            id="org.openehealth.ipf.platform.manager.ui.flows.active.part">
         <and>
            <with
                  variable="activePartId">
               <equals
                     value="org.openehealth.ipf.platform.manager.flowmanager.ui.view.SearchView">
               </equals>
            </with>
         </and>
      </definition>
      <definition
            id="org.openehealth.ipf.platform.manager.flowmanager.ui.single.selection">
         <and>
            <with
                  variable="selection">
               <count
                     value="1">
               </count>
            </with>
            <with
                  variable="activePartId">
               <equals
                     value="org.openehealth.ipf.platform.manager.flowmanager.ui.view.SearchView">
               </equals>
            </with>
         </and>
      </definition>
   </extension>
   <!-- defined in the connection UI plugin (re-design of UI will be considered in the next release)-->
   <extension point="org.eclipse.ui.perspectiveExtensions">
      <perspectiveExtension
            targetID="org.openehealth.ipf.platform.manager.connection.ui.perspective.DefaultPerspective">
         <view
               closeable="false"
               id="org.openehealth.ipf.platform.manager.flowmanager.ui.view.SearchView"
               minimized="false"
               ratio="0.6"
               relationship="stack"
               relative="org.openehealth.ipf.platform.manager.connection.ui.perspective.DefaultPerspective.bottom.results"
               showTitle="true"
               standalone="false"
               visible="true">
         </view>
         <view
               closeable="true"
               id="org.openehealth.ipf.platform.manager.flowmanager.ui.view.FlowContnetViewPart"
               minimized="false"
               ratio="0.6"
               relationship="stack"
               relative="org.openehealth.ipf.platform.manager.connection.ui.perspective.DefaultPerspective.bottom.results"
               showTitle="true"
               visible="true">
         </view>
         <viewShortcut
               id="org.openehealth.ipf.platform.manager.flowmanager.ui.view.SearchView">
         </viewShortcut>
         <viewShortcut
               id="org.openehealth.ipf.platform.manager.flowmanager.ui.view.FlowContnetViewPart">
         </viewShortcut>
      </perspectiveExtension>
   </extension>
   <extension
         point="org.eclipse.ui.views">
      <view
            allowMultiple="false"
            category="org.openehealth.ipf.platform.manager.flowmanager.ui.category"
            class="org.openehealth.ipf.platform.manager.flowmanager.ui.view.SearchView"
            icon="icons/arrow_branch.png"
            id="org.openehealth.ipf.platform.manager.flowmanager.ui.view.SearchView"
            name="%flows_result_view_name">
      </view>
      <view
            allowMultiple="false"
            category="org.openehealth.ipf.platform.manager.flowmanager.ui.category"
            class="org.openehealth.ipf.platform.manager.flowmanager.ui.view.FlowContnetViewPart"
            icon="icons/email.png"
            id="org.openehealth.ipf.platform.manager.flowmanager.ui.view.FlowContnetViewPart"
            name="%flow_messages_view_title">
      </view>
      <category
            id="org.openehealth.ipf.platform.manager.flowmanager.ui.category"
            name="%flowmanager_category">
      </category>
   </extension>
   <extension
         point="org.eclipse.core.runtime.preferences">
      <initializer
            class="org.openehealth.ipf.platform.manager.flowmanager.ui.preferences.FlowManagerPreferencesInitializer">
      </initializer>
   </extension>
   <extension
         point="org.eclipse.ui.preferencePages">
      <page
            class="org.openehealth.ipf.platform.manager.flowmanager.ui.preferences.FlowManagerPreferencePage"
            id="org.openehealth.ipf.platform.manager.flowmanager.ui.page1"
            name="%flow_manager_preference_page_name">
      </page>
   </extension>
</plugin>
